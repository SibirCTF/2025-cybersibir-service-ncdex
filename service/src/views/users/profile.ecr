<% title = "–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" %>

<div class="container neon-container">
    <div class="card bg-dark text-light border-neon mb-4">
        <div class="card-header bg-primary">
        <h3 class="mb-0">üë§ <%= current_user.username %> (–ü—Ä–æ—Ñ–∏–ª—å)</h3>
        </div>
        <div class="card-body">
        <p><strong>Email:</strong> <%= current_user.email %></p>
        <p><strong>–ë–∞–ª–∞–Ω—Å:</strong> <span id="user-balance"><%= current_user.balance %></span> –∫—Ä–µ–¥–∏—Ç–æ–≤</p>
        <p><strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong> <%= current_user.created_at.to_s("%d.%m.%Y %H:%M") %></p>
        </div>
    </div>

    <div class="card bg-dark text-light border-neon mb-4">
        <div class="card-header bg-primary">
        <h4 class="mb-0">üí∞ –ú–æ–∏ –ø—Ä–æ–¥–∞–∂–∏</h4>
        </div>
        <div class="card-body">
        <% if own_vulnerabilities && own_vulnerabilities.any? %>
            <table class="table table-dark table-bordered table-hover">
            <thead>
                <tr class="bg-primary text-light">
                <th>NCVE</th>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                <th>–¶–µ–Ω–∞</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                </tr>
            </thead>
            <tbody>
                <% own_vulnerabilities.each do |v| %>
                <tr>
                    <td>
                    <a href="/vulnerabilities/<%= v.id %>" class="text-warning">
                        <%= v.cve_code %>
                    </a>
                    </td>
                    <td><%= v.title %></td>
                    <td><%= v.price %> –∫—Ä–µ–¥–∏—Ç–æ–≤</td>
                    <td>
                    <% if v.status == "sold" %>
                        <span class="badge bg-primary">–ü—Ä–æ–¥–∞–Ω–æ</span>
                    <% else %>
                        <span class="badge bg-success">–î–æ—Å—Ç—É–ø–Ω–æ</span>
                    <% end %>
                    </td>
                </tr>
                <% end %>
            </tbody>
            </table>
        <% else %>
            <p class="text-center text-muted">–ù–µ—Ç –ø—Ä–æ–¥–∞–∂</p>
        <% end %>
        </div>
    </div>

    <div class="card bg-dark text-light border-neon mb-4">
        <div class="card-header bg-primary">
        <h4 class="mb-0">üõí –ö—É–ø–ª–µ–Ω–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏</h4>
        </div>
        <div class="card-body">
        <% if purchased_vulnerabilities && purchased_vulnerabilities.any? %>
            <table class="table table-dark table-bordered table-hover">
            <thead>
                <tr class="bg-primary text-light">
                <th>NCVE</th>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                <th>–¶–µ–Ω–∞</th>
                <th>–î–∞—Ç–∞ –ø–æ–∫—É–ø–∫–∏</th>
                </tr>
            </thead>
            <tbody>
                <% purchased_vulnerabilities.each do |v| %>
                <tr>
                    <td>
                    <a href="/vulnerabilities/<%= v.vulnerability_id %>" class="text-warning">
                        <%= v.cve_code %>
                    </a>
                    </td>
                    <td><%= v.title %></td>
                    <td><%= v.amount %> –∫—Ä–µ–¥–∏—Ç–æ–≤</td>
                    <td><%= v.created_at.to_s("%d.%m.%Y %H:%M") %></td>
                </tr>
                <% end %>
            </tbody>
            </table>
        <% else %>
            <p class="text-center text-muted">–ù–µ—Ç –∫—É–ø–ª–µ–Ω–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π</p>
        <% end %>
        </div>
    </div>

    <div class="card bg-dark text-light border-neon mb-4">
        <div class="card-header bg-primary">
        <h4 class="mb-0">üìú –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</h4>
        </div>
        <div class="card-body">
        <% if history_of_transactions && history_of_transactions.any? %>
            <table class="table table-dark table-bordered table-hover">
            <thead>
                <tr class="bg-primary text-light">
                    <th>–°—É–º–º–∞</th>
                    <th>–û—Ç –∫–æ–≥–æ</th>
                    <th>–ö–æ–º—É</th>
                    <th>–¢–∏–ø</th>
                    <th>–î–∞—Ç–∞</th>
                </tr>
            </thead>
            <tbody>
                <% history_of_transactions.each do |t| %>
                <tr>
                    <td><a href="/transactions/<%= t.id %>"><%= t.amount %> –∫—Ä–µ–¥–∏—Ç–æ–≤</a></td>
                    <td><%= t.from_user %></td>
                    <td><%= t.to_user %></td>
                    <td>
                    <% case t.transaction_type
                        when "purchase" %>
                        <span class="badge bg-success">üõí –ü–æ–∫—É–ø–∫–∞</span>
                        <% when "bonus" %>
                        <span class="badge bg-warning">üéÅ –ë–æ–Ω—É—Å</span>
                        <% when "transfer" %>
                        <span class="badge bg-info">üîÅ –ü–µ—Ä–µ–≤–æ–¥</span>
                        <% else %>
                        <span class="badge bg-secondary">‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</span>
                    <% end %>
                    </td>
                    <td><%= t.created_at.to_s("%d.%m.%Y %H:%M") %></td>
                </tr>
                <% end %>
            </tbody>
            </table>
        <% else %>
            <p class="text-center text-muted">–ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</p>
        <% end %>
        </div>
    </div>
    <div class="text-center mt-4">
        <a href="/users/transfer" class="btn-neon-secondary">üîÄ –ü–µ—Ä–µ–≤–æ–¥—ã</a>
    </div>
</div>
